<!DOCTYPE html>
<html lang="en">
<head>
    <title>Đăng nhập - ShipperManager</title>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="images/logo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!--===============================================================================================-->
    <link rel="icon" type="image/png" href="../../public/images/icons/favicon.ico"/>
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="css/util.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/popup.css">
    <!--===============================================================================================-->
</head>
<body>
<form method="POST" action="/api/user/login">

<div class="limiter">
    <div class="container-login100" style="background-image: url('images/background.jpg');">
        <div class="wrap-login100 p-l-55 p-r-55 p-t-65 p-b-54" style="background: #ffffffd9">
            <form class="login100-form validate-form">
					<span class="login100-form-title p-b-49">
                        <img src="images/logo_chu.png" style="width: 90%;height: 70px;margin-bottom:20px">
                        <h3>Đăng nhập</h3>
					</span>

                <div class="wrap-input100 validate-input m-b-23" data-validate = "Tên tài khoản là bắt buộc">
                    <span class="label-input100">Tên đăng nhập</span>
                    <input id="username" class="input100" type="text" name="username" placeholder="Nhập tài khoản">
                    <span class="focus-input100" data-symbol="&#xf206;"></span>
                </div>

                <div class="wrap-input100 validate-input" data-validate="Mật khẩu là bắt buộc">
                    <span class="label-input100">Mật khẩu</span>
                    <input id="password" class="input100" type="password" name="pass" placeholder="Nhập mật khẩu">
                    <span class="focus-input100" data-symbol="&#xf190;"></span>
                </div>

                <div class="text-right p-t-8 p-b-31">
                    <input id="checkRemenberPass" type="checkbox" name="vehicle" value="Bike"> Ghi nhớ mật khẩu<br>

                    <!--<a href="#" style="font-family: normal">-->
                        <!--Quên mật khẩu?-->
                    <!--</a>-->
                </div>

                <div class="container-login100-form-btn">
                    <div class="wrap-login100-form-btn">
                        <div class="login100-form-bgbtn"></div>
                        <button id = "btnLogin" class="login100-form-btn" type="submit">
                            Đăng nhập
                        </button>
                    </div>
                </div>
                <div style="margin-top: 5%;margin-left: 5%;margin-right: 5%;margin-bottom: -5%">
                    <p style="font-style: italic;font-family: normal; text-align: center">Bằng click vào đăng nhập, bạn đã chấp nhận những điều khoản của chúng tôi</p>
                </div>

                <!-- <div class="flex-c-m">
                    <a href="#" class="login100-social-item bg1">
                        <i class="fa fa-facebook"></i>
                    </a>

                    <a href="#" class="login100-social-item bg2">
                        <i class="fa fa-twitter"></i>
                    </a>

                    <a href="#" class="login100-social-item bg3">
                        <i class="fa fa-google"></i>
                    </a>
                </div> -->

                <!-- <div class="flex-col-c p-t-155">
                    <span class="txt1 p-b-17">
                        Or Sign Up Using
                    </span>

                    <a href="#" class="txt2">
                        Sign Up
                    </a>
                </div> -->
            </form>
        </div>
    </div>
</div>
</form>
<script src='https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.3/TweenMax.min.js'></script>

<script>
    var isRememberPass = false
    $( document ).ready(function() {
        var data = JSON.parse(localStorage.getItem("rememberpass"))
        if(data){
            $('#username').val(data.username)
            $('#password').val(data.password)
            $('#checkRemenberPass').prop('checked',true)

        }

    });
    $('#checkRemenberPass').click(function () {
        isRememberPass = !isRememberPass
        $(this).prop('checked',isRememberPass)
    })
    $('#btnLogin').click(function (event, err) {
        // alert('pppppppp'+err);
        if(!err) {
            event.preventDefault();
            let username = $('#username').val();
            let password = $('#password').val();
            let tokenfirebase = ""
            if (!username || !password) {
                alert('Vui lòng nhập tài khoản hoặc mật khẩu!')
            } else {

                $.ajax('/api/user/login', {
                    type: "POST",
                    data: {
                        username, password
                    },
                    dataType: "json",
                    success: function (data) {
                        console.log(data);
                        if (data.status) {
                            if(isRememberPass){
                                localStorage.setItem('rememberpass', JSON.stringify({"username":username,"password":password}));
                            }else {
                                localStorage.removeItem('rememberpass');
                            }
                            localStorage.setItem('user', JSON.stringify(data.data));
                            window.location.href = "/"
                            // $(event.currentTarget).trigger('click', {'handle': true});
                        } else {
                            alert(data.msg)

                        }
                    },
                    error: function (err) {
                        console.log(err)
                        window.location.href = "/"

                        alert('Lỗi! Không có kết nối, vui lòng thử lại sau.' + err)
                    }
                });
            }
        }else {
            return
        }

    })

</script>

<!-- <div id="dropDownSelect1"></div>
 -->
<!--<div class="popup" data-popup="popup-1">-->
    <!--<div class="popup-inner">-->
        <!--<h2 style="text-align: center; font-family: Arial, Helvetica, sans-serif;">Đăng nhập</h2>-->
        <!--<p class="label-input100" style="text-align: center; margin: 10px;">Tên tài khoản hoặc mật khẩu không đúng!</p>-->
        <!--<a class="popup-close" data-popup-close="popup-1" href="#">x</a>-->
    <!--</div>-->
<!--</div>-->
<!--===============================================================================================-->
<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
<script src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
<script src="vendor/bootstrap/js/popper.js"></script>
<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
<script src="vendor/select2/select2.min.js"></script>
<!--===============================================================================================-->
<script src="vendor/daterangepicker/moment.min.js"></script>
<script src="vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
<script src="vendor/countdowntime/countdowntime.js"></script>
<!--===============================================================================================-->
<!--<script src="js/main.js"></script>-->
<!--<script src = "js/index.js"></script>-->
</body>
</html>